<!DOCTYPE html>
<html lang="en">
<head>
	<title>tripy</title>
	<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
<!--===============================================================================================-->	
	<link rel="icon" type="image/png" href="images/icons/favicon.png"/>
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/animate/animate.css">
<!--===============================================================================================-->	
	<link rel="stylesheet" type="text/css" href="vendor/css-hamburgers/hamburgers.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/animsition/css/animsition.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/select2/select2.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/slick/slick.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/MagnificPopup/magnific-popup.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="css/util.min.css">
<!--===============================================================================================-->	
	<link rel="stylesheet" type="text/css" href="css/main.css">
<!--===============================================================================================-->
</head>
<body class="animsition">

	<!-- Header -->
	<header>
		<!-- Header desktop -->
		<nav class="container-header-desktop">
			<div class="wrap-menu-desktop">
				<div class="limiter-menu-desktop container">					
					<!-- Logo desktop -->		
					<div class="logo">
						<a href="index.html"><img src="images/icons/newlogo.png" alt="LOGO"></a>
					</div>
					<!-- Menu desktop -->
					<div class="menu-desktop">
						<ul class="main-menu respon-sub-menu">
							<li>
								<a href="tripy-City.html" style="font-weight: bold;">景點</a>
							</li>

							<li>
								<a href="tripy-StartPlanning.html" style="font-weight: bold;">觀光行程</a>
							</li>

							<li>
								<a href="tripy-FavoriteList.html" style="font-weight: bold;">我的收藏</a>
							</li>
							<li>
								<a href="tripy-login.html" class="hide-menu" style="font-weight: bold;">登入</a>
								
							</li>
							<li>
								<a href="tripy-login.html" style="font-weight: bold;">我的帳號</a>
								<ul class="sub-menu bold-chinese-text">
									<li><a href="tripy-SeeAllMember.html">檢視所有會員</a></li>
									<li><a href="tripy-SeeAllAdmin.html">檢視所有管理員</a></li>
									<li><a href="tripy-AddAdmin.html">新增管理員</a></li>
								</ul>
							</li>
						</ul>
					</div>					
				</div>
			</div>	
		</nav>
		<style>
            .bold-chinese-text {
                font-family: '微軟正黑體', sans-serif;
                font-weight: bold; 
            }
        </style>
	</header>

	<!-- Title page -->
	<section class="bg-img1 " style="background-image: url(images/旅遊.jpg);">
		<div class="container size-h-3 p-tb-30 flex-col-c-c">
			<h2 class="t1-b-1 text-uppercase cl-0 txt-center m-b-25" style="font-weight: bold;">
				體驗各種美好生活
			</h2>
		</div>
	</section>

	<!-- Content -->
	<div class="bg-0 p-t-95 p-b-50">
		<div class="p-rl-50 p-rl-15-sr1199">
			<div class="p-b-45">
				<div class="flex-wr-c-c filter-tope-group">
					<button class="t1-m-6 cl-16 hov-btn3 trans-02 p-rl-10 p-tb-3 m-all-5 active-2" id="all" >
						所有目的地
					</button>

					
				</div>
			</div>
			<div class="row isotope-grid" id="City_panel">
				

				
				
			</div>
		</div>

		<script>
			
			$(document).ready(function () {
    			Districts();
    			getAllCity()
			});

			function Districts() {
            $.ajax({
                type: "GET",
                url: "http://localhost:8090/NCU_MIS_SA/api/district.do",
                crossDomain: true,
                cache: false,
                dataType: 'json',
                timeout: 5000,
                success: function (response) {
                    if (response.status == 200) {
                        var districtButtons = '';

                        $.each(response.response.data, function () {
							console.log("All Districts: ", response.response.data)
                            districtButtons += '<button class="t1-m-6 cl-16 hov-btn3 trans-02 p-rl-10 p-tb-3 m-all-5" data-district-id="' + this.id + '">' +
                                this.first_name +
                                '</button>';
                        });

                        $(".filter-tope-group").append(districtButtons);

						// 獲取所有具有 'm-all-5' 類別的按鈕元素
     					var districtButtons = document.querySelectorAll('.m-all-5');
						// 對每個按鈕設置點擊事件監聽器
     					districtButtons.forEach(function(button) {
         					button.addEventListener('click', function() {
            				// 獲取 data-district-id 屬性的值
            				var districtId = this.getAttribute('data-district-id');

           					// 調用函式並傳遞 districtId
           					//console.log(districtId);
           					if(districtId==null){
								   getAllCity();
							   }
           					else{
								   //console.log(districtId);
								   getCitiesByDistrictId(districtId);
								   
								   //按鈕根據點選改顏色
								   districtButtons.forEach(function (btn) {
                                   btn.classList.remove('active-2');
                           		   });
                            	   this.classList.add('active-2');
                            	   
							   }
           					});
      					});
                        
                        
                    }
                },
                error: function () {
                    alert("無法連線到伺服器！!");
                }
            });
        }
        
		
        
	
        
			
			//document.getElementById('all').addEventListener('click', getAllCity);

			function getAllCity() {
				$("#City_panel").empty();
				$.ajax({
					
				  type: "GET",
				  url: "http://localhost:8090/NCU_MIS_SA/api/city.do",
				  crossDomain: true,
				  cache: false,
				  dataType: 'json',
				  timeout: 5000,
				  success: function (response) {
					if (response.status == 200) {
					  var city_panel = '';
					  
					  $.each(response.response.data, function (){
						  //console.log(response.response.data);
						  city_panel += addAllCity(this);
					  })
					  
					  $("#City_panel").append(city_panel);

					  
					}
				  },
				  error: function () {
					alert("無法連線到伺服器！");
				  }
				});
			  }


			function addAllCity(data) {
				console.log(data);
    			let inner_html = '';
    			inner_html += '<div class="col-sm-6 col-lg-4 p-b-45 ">';
   				inner_html += '<div class="flex-col-s-c">';
				inner_html += '<div class="w-full pos-relative wrap-pic-w m-b-16">';
 				//inner_html += '<img src="statics/img/city/' + data.image + '" height= "280px" >';
				inner_html += '<div class="s-full ab-t-l flex-col-c-c hov-1 p-tb-30 p-rl-15">';
				inner_html += '<a href="tripy-Scene.html" class="size-a-15 d-inline-flex flex-c-c bg-11 t1-s-2 text-uppercase cl-0 hov-btn2 trans-02 p-rl-10 hov-1-2">';
				inner_html += '找景點';
				inner_html += '</a>';
				inner_html += '</div></div>';
				inner_html += '<a href="tripy-Scene.html?scene_id=" '+data.id+' class="t1-m-1 cl-3 hov-link2 trans-02">';
				inner_html += data.city_info.name;
				inner_html += '</a>';
				inner_html += '</div></div>';
				
    	
				return inner_html;
 		  	}
 		  	
 		  	

			//get各區city
			function getCitiesByDistrictId(id) {
				
				//console.log(id)
				$.ajax({
				  type: "GET",
				  url: "http://localhost:8090/NCU_MIS_SA/api/district.do",
				  crossDomain: true,
				  cache: false,
				  dataType: 'json',
				  data: { id: id },
				  timeout: 5000,
				  success: function (response) {
					if (response.status == 200) {
					  var city_panel = '';
					  //console.log(response);

					  
					  $.each(response, function (){
						  
						  city_panel += addCityByDistrictId(this);
						  //console.log (response);
						  
					  })
					  
					  $("#City_panel").empty();
					  $("#City_panel").append(city_panel);
					  
					  
					}
				  },
				  error: function () {
					alert("無法連線到伺服器！");
				  }
				});
			}
			
			//把district中的 city 轉成html進去
			function addCityByDistrictId(data) {
				let inner_html = '';
				
				//console.log(data);
           		
       		
       			if (data.data && data.data.length > 0 && data.data[0].product_info && data.data[0].product_info.length > 0) {
        			for (let i = 0; i < data.data[0].product_info.length; i++) {
						inner_html += '<div class="col-sm-6 col-lg-4 p-b-45 ">';
       					inner_html += '<div class="flex-col-s-c">';
						inner_html += '<div class="w-full pos-relative wrap-pic-w m-b-16">';
						inner_html += '<div class="s-full ab-t-l flex-col-c-c hov-1 p-tb-30 p-rl-15">';
						inner_html += '<a href="tripy-Scene.html" class="size-a-15 d-inline-flex flex-c-c bg-11 t1-s-2 text-uppercase cl-0 hov-btn2 trans-02 p-rl-10 hov-1-2">';
						inner_html += '找景點';
						inner_html += '</a>';
						inner_html += '</div></div>';
			            inner_html += '<a href="tripy-Scene.html?scene_id=' + data.data[0].product_info[i].id + '" class="t1-m-1 cl-3 hov-link2 trans-02">';
			            inner_html += data.data[0].product_info[i].name;
			            inner_html += '</a>';
			            inner_html += '</div></div>';

			        }
		   		} else {
		        	console.error('Invalid data structure or missing product_info.');
		   		}
		

				return inner_html;
			}

				


		</script>	

			
			
	</div>
	
	
	


<!--===============================================================================================-->	
	<script src="vendor/jquery/jquery-3.2.1.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor/animsition/js/animsition.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor/bootstrap/js/popper.js"></script>
	<script src="vendor/bootstrap/js/bootstrap.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor/select2/select2.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor/parallax100/parallax100.js"></script>
<!--===============================================================================================-->
	<script src="vendor/waypoint/jquery.waypoints.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor/countterup/jquery.counterup.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor/slick/slick.min.js"></script>
	<script src="js/slick-custom.js"></script>
<!--===============================================================================================-->
	<script src="vendor/MagnificPopup/jquery.magnific-popup.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor/isotope/isotope.pkgd.min.js"></script>
<!--===============================================================================================-->
	<script src="js/main.js"></script>

</body>
</html>
